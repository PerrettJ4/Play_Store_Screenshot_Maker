<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>HTML 5 Boilerplate</title>
    <!-- <link rel="stylesheet" href="style.css"> -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat&family=Open+Sans:wght@500;600;700&display=swap"
        rel="stylesheet">
</head>

<body>
    <h1>James' Screenshot Software</h1>
    <div id='container' style='display: flex; flex-direction: row;'></div>

    <script>

        const one = "#3201c8"
        const two = "#ff335e"
        const f1 = "#d20515"
        const wc = "#FD5212"
        const f2 = "#C0C0C0"
        const seriea = "#002d71"
        const seriea2 = "#008fd7"
        const championship = "#a69038"

        function createTile(txtArray = [['foo bar. foo bar', one], ['find my. facility is the best', one]]) {

            const settings = ["",
                { height: '3840', width: '2160', font: "160px Open sans", lineHeight: 200, ES: 0 },
                { height: '2732', width: '2048', font: "150px Open sans", lineHeight: 160, ES: 800 },
                { height: '2778', width: '1284', font: "90px Open sans", lineHeight: 130, ES: -450 },
                { height: '2796', width: '1290', font: "95px Open sans", lineHeight: 130, ES: -430 },
                { height: '2208', width: '1242', font: "90px Open sans", lineHeight: 120, ES: 0 }]




            for (x = 0; x < txtArray.length; x++) {
                for (let p = 1; p < settings.length; p++) {
                    function roundedImage(x, y, width, height, radius) {
                        ctx.beginPath();
                        ctx.moveTo(x + radius, y);
                        ctx.lineTo(x + width - radius, y);
                        ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
                        ctx.lineTo(x + width, y + height - radius);
                        ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
                        ctx.lineTo(x + radius, y + height);
                        ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
                        ctx.lineTo(x, y + radius);
                        ctx.quadraticCurveTo(x, y, x + radius, y);
                        ctx.closePath();
                    }
                    const tile = document.createElement('div')
                    tile.style.display = "flex"
                    tile.style.flexDirection = "column"
                    const containerRow = document.querySelector('#container')
                    containerRow.appendChild(tile)
                    tile.innerHTML =
                        `<button type="button" id="btnDisplay${p}${x}" style="height:200px; font-size:50px;">Display</button>
                <button type="button" id="btnDownload${p}${x}" style="height:200px; font-size:50px;"">Download</button>
                <!-- 3840 2160 1920 1080-->
                <canvas id="myCanvas${p}${x}" height=${settings[p].height} width=${settings[p].width} style="border: 2px solid #000; float: left;"></canvas>
                <img src="" id="imgConverted${p}${x}" style="float: left; border: 2px solid #00f; margin-left: 10px;" />
                <img id='screenshot${p}${x}' style='display: none;' src='./Screenshots_FT_PL/${x + 1}.png' />`





                    const btnDisplay = document.querySelector(`#btnDisplay${p}${x}`);
                    const btnDownload = document.querySelector(`#btnDownload${p}${x}`);
                    const imgConverted = document.querySelector(`#imgConverted${p}${x}`);
                    const myCanvas = document.querySelector(`#myCanvas${p}${x}`);
                    const screenshot = document.querySelector(`#screenshot${p}${x}`)
                    const ctx = myCanvas.getContext('2d', { alpha: false });

                    const txt = txtArray[x][0].toUpperCase()
                    //Math.round(Math.random())
                    if (false) {
                        //plain bg
                        ctx.fillStyle = txtArray[x][1]
                    } else {
                        // Create gradient
                        const randomDec = Math.random() + 0.6

                        var grd = ctx.createRadialGradient(myCanvas.width / 2, myCanvas.height * 3 * randomDec / 4, 0, myCanvas.width / 2, myCanvas.height * randomDec * 3 / 4, (myCanvas.height / 2 * (randomDec - 0.2)));

                        grd.addColorStop(1, "whitesmoke");
                        grd.addColorStop(0, "#ffffff");


                        // Fill with gradient
                        ctx.fillStyle = grd;
                    }
                    ctx.fillRect(0, 0, myCanvas.width, myCanvas.height)
                    ctx.fillStyle = "#000000"
                    ctx.font = settings[p].font
                    ctx.textAlign = 'center'
                    var lineheight = settings[p].lineHeight;
                    const lines = txt.split('.');
                    const shadowColor = txtArray[x][1]

                    for (var i = 0; i < lines.length; i++)
                        ctx.fillText(lines[i], myCanvas.width / 2, myCanvas.height * 1 / 11 + (i * lineheight));

                    screenshot.addEventListener('load', (e) => {
                        const start = lines.length === 3 ? 2.5 : lines.length === 2 ? 2 : txt.length === 0 ? 1 : 1.5

                        const shadowSizeConfig = [
                            (myCanvas.width / 10) - 15, (myCanvas.height * start / 10) - 15, //shadow start
                            (myCanvas.width * 8 / 10) + 70 - 40, myCanvas.height + settings[p].ES - 40 //shadow end
                        ]
                        const phoneSizeConfig = [
                            myCanvas.width / 10, myCanvas.height * start / 10, //image start
                            (myCanvas.width * 8 / 10), myCanvas.height + settings[p].ES - 70  //image end
                        ]
                        ctx.save();
                        roundedImage(
                            ...shadowSizeConfig,
                            135 //corner radius
                        )
                        ctx.clip();
                        console.log(shadowColor)
                        ctx.fillStyle = shadowColor
                        ctx.fillRect(...shadowSizeConfig)
                        ctx.restore();

                        ctx.save();
                        roundedImage(
                            ...phoneSizeConfig,
                            120 //corner radius
                        )
                        ctx.clip();
                        ctx.drawImage(screenshot,
                            0, 120, //grab start
                            screenshot.width, screenshot.height - 154, //grab end
                            ...phoneSizeConfig
                        );
                        ctx.restore();




                    });

                    btnDisplay.addEventListener("click", function () {
                        const dataURI = myCanvas.toDataURL();
                        imgConverted.src = dataURI
                        console.log(dataURI)
                    })

                    btnDownload.addEventListener("click", function () {
                        const a = document.createElement(`a`)
                        console.log(x)
                        // appending/removing only for Firefox
                        document.body.appendChild(a);
                        a.href = myCanvas.toDataURL();
                        a.download = `${settings[p].height}-${p}-${x}.png`
                        a.click()
                        document.body.removeChild(a)
                    })
                }
            }
        }
        const screenshotStory1 = [['access local.sports facilities', 0], ['find details.of any facility', 1], ['view activities', 1], ['find opening times', 1], ['discover local. classes', 0], ['explore class.details', 1], ['filter by sports', 0], ['select your.favourite sports', 1]]
        const screenshotStoryOld = [['', 1], ['‚öΩ üèà üèÄ üèÅ', 0], ['', 2], ['challenge friends', 1], ['Create leagues.with friends', 0], ["", 0]]
        const screenshotStory2 = [['Predict leagues', one], ['Share or save.your prediction', seriea], ['compete vs.the üåç', wc], ['create private.leagues with mates', f1], ['', championship]]
        const screenshotStory3 = [['Predict the 2022. world cup', 0], ['Share or save.your tree', 0], ['compete vs. others', 0], ['collect badges,earn medals', 0], ['', 0], ['light or.dark mode', 1], ['', 1], ['', 0], ['', 0], ['Check out your.friends trees', 0]]
        createTile(screenshotStory2)

    </script>
</body>

</html>