<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>HTML 5 Boilerplate</title>
    <!-- <link rel="stylesheet" href="style.css"> -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="./style.css">
</head>

<body>
    <h1>James' Screenshot Software</h1>
    <div id='container' style='display: flex; flex-direction: row;'></div>
    <img id='splash2' style='display: none;' src='./splash2.png' />

    <script>

        const one = "#3201c8"
        const two = "#ff335e"
        const f1 = "#d20515"
        const wc = "#FD5212"
        const f2 = "#C0C0C0"
        const seriea = "#002d71"
        const seriea2 = "#008fd7"
        const championship = "#a69038"
        const phoneBorder = "#0f0f0f11"
        function createTile(txtArray = [['foo bar. foo bar', one], ['find my. facility is the best', one]]) {

            const settings = ["",
                { height: '3840', width: '2160', font: "195px myFirstFont", lineHeight: 200, ES: 200 },
                { height: '2732', width: '2048', font: "180px myFirstFont", lineHeight: 160, ES: 1200 },
                { height: '2778', width: '1284', font: "115px myFirstFont", lineHeight: 130, ES: -450 },
                { height: '2796', width: '1290', font: "115px myFirstFont", lineHeight: 130, ES: -450 },
                { height: '2208', width: '1242', font: "110px myFirstFont", lineHeight: 120, ES: 200 }]




            for (x = 0; x < txtArray.length; x++) {
                for (let p = 1; p < settings.length; p++) {
                    function roundedImage(x, y, width, height, radius) {
                        ctx.beginPath();
                        ctx.moveTo(x + radius, y);
                        ctx.lineTo(x + width - radius, y);
                        ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
                        ctx.lineTo(x + width, y + height - radius);
                        ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
                        ctx.lineTo(x + radius, y + height);
                        ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
                        ctx.lineTo(x, y + radius);
                        ctx.quadraticCurveTo(x, y, x + radius, y);
                        ctx.closePath();
                    }
                    const tile = document.createElement('div')
                    tile.style.display = "flex"
                    tile.style.flexDirection = "column"
                    const containerRow = document.querySelector('#container')
                    containerRow.appendChild(tile)
                    tile.innerHTML =
                        `<button type="button" id="btnDisplay${p}${x}" style="height:200px; font-size:50px;">Display</button>
                <button type="button" id="btnDownload${p}${x}" style="height:200px; font-size:50px;"">Download</button>
                <!-- 3840 2160 1920 1080-->
                <canvas id="myCanvas${p}${x}" height=${settings[p].height} width=${settings[p].width} style="border: 2px solid #000; float: left;"></canvas>
                <img src="" id="imgConverted${p}${x}" style="float: left; border: 2px solid #00f; margin-left: 10px;" />
                <img id='screenshot${p}${x}' style='display: none;' src='./Screenshots_FT_PL/${x + 1}.png' />;`





                    const btnDisplay = document.querySelector(`#btnDisplay${p}${x}`);
                    const btnDownload = document.querySelector(`#btnDownload${p}${x}`);
                    const imgConverted = document.querySelector(`#imgConverted${p}${x}`);
                    const myCanvas = document.querySelector(`#myCanvas${p}${x}`);
                    const splash2 = document.querySelector(`#splash2`)
                    const screenshot = document.querySelector(`#screenshot${p}${x}`)
                    const ctx = myCanvas.getContext('2d', { alpha: false });

                    const txt = txtArray[x][0].toUpperCase()
                    //Math.round(Math.random())
                    if (false) {
                        //plain bg
                        ctx.fillStyle = txtArray[x][1]
                    } else {
                        // Create gradient
                        const middleX = myCanvas.width / 2
                        const middleY = myCanvas.height / 2
                        const apsectRatio = middleX / middleY
                        const innerRadius = middleX * 1.4
                        const outerRadius = middleX * 3
                        var grd = ctx.createRadialGradient(middleX, middleY, innerRadius, middleX, middleY, outerRadius);

                        grd.addColorStop(1, one);
                        grd.addColorStop(0, two);
                        ctx.fillStyle = grd;
                    }
                    ctx.fillRect(0, 0, myCanvas.width, myCanvas.height)
                    ctx.fillStyle = "grey"
                    ctx.font = settings[p].font
                    ctx.textAlign = 'center'
                    var lineheight = settings[p].lineHeight;
                    const lines = txt.split('.');
                    const shadowColor = 'black'

                    const hRatio = myCanvas.width / splash2.width;
                    const vRatio = myCanvas.height / splash2.height;
                    const ratio = Math.min(hRatio, vRatio);

                    const randomOffsetX = (settings[p].width * Math.random()) - settings[p].width
                    const randomOffsetY = settings[p].height / 5 + (settings[p].height * Math.random())

                    const pbCoeff = myCanvas.width / 1242



                    for (var i = 0; i < lines.length; i++) {
                        const text = lines[i];
                        const xc = myCanvas.width / 2;
                        const yc = myCanvas.height * 1 / 9 + (i * lineheight);

                        ctx.fillStyle = one;
                        ctx.fillText(text, xc - xc / 100, yc - yc / 35);
                        ctx.fillText(text, xc + xc / 70, yc - yc / 35);
                        ctx.fillText(text, xc - xc / 100, yc);
                        ctx.fillStyle = two;
                        ctx.fillText(text, xc + xc / 70, yc);
                        ctx.fillText(text, xc - xc / 100, yc + yc / 60);
                        ctx.fillText(text, xc + xc / 70, yc + yc / 60);
                        ctx.fillStyle = 'white'
                        ctx.fillText(text, xc, yc);


                        screenshot.addEventListener('load', (e) => {
                            const start = lines.length === 3 ? 2.5 : lines.length === 2 ? 2 : txt.length === 0 ? 1 : 1.5

                            const shadowSizeConfig = [
                                (myCanvas.width / 24) - pbCoeff * 35, (myCanvas.height * start / 8) - pbCoeff * 35, //shadow start
                                (myCanvas.width * 22 / 24) + pbCoeff * 70 - 0, myCanvas.height + settings[p].ES + pbCoeff *70- 0 //shadow end
                            ]
                            const phoneSizeConfig = [
                                myCanvas.width / 24, myCanvas.height * start / 8, //image start
                                (myCanvas.width * 22 / 24), myCanvas.height + settings[p].ES - pbCoeff * 70 / 6  //image end
                            ]
                            ctx.save();
                            roundedImage(
                                ...shadowSizeConfig,
                                110 * pbCoeff //corner radius
                            )
                            ctx.clip();
                            console.log(shadowColor)
                            ctx.fillStyle = shadowColor
                            ctx.fillRect(...shadowSizeConfig)
                            ctx.restore();

                            ctx.save();
                            roundedImage(
                                ...phoneSizeConfig,
                                100 * pbCoeff //corner radius
                            )
                            ctx.clip();
                            ctx.drawImage(screenshot,
                                0, 120, //grab start
                                screenshot.width, screenshot.height - 154, //grab end
                                ...phoneSizeConfig
                            );
                            ctx.restore();




                        });

                        btnDisplay.addEventListener("click", function () {
                            const dataURI = myCanvas.toDataURL();
                            imgConverted.src = dataURI
                            console.log(dataURI)
                        })


                        function downloadImage() {
                            const a = document.createElement('a');
                            console.log(x);
                            // appending/removing only for Firefox
                            document.body.appendChild(a);
                            a.href = myCanvas.toDataURL();
                            a.download = `${settings[p].height}-${p}-${x}.png`;
                            a.click();
                            document.body.removeChild(a);
                        }
                     //  setTimeout(downloadImage, 10000);
                    }
                }
            }
        }
        const screenshotStory1 = [['access local.sports facilities', 0], ['find details.of any facility', 1], ['view activities', 1], ['find opening times', 1], ['discover local. classes', 0], ['explore class.details', 1], ['filter by sports', 0], ['select your.favourite sports', 1]]
        const screenshotStoryOld = [['', 1], ['⚽ 🏈 🏀 🏁', 0], ['', 2], ['challenge friends', 1], ['Create leagues.with friends', 0], ["", 0]]
        //const screenshotStory2 = [['create your.prediction', two], ['versus friends', phoneBorder], ['and the world!', phoneBorder],['Make your player', phoneBorder], ['earn rewards!', phoneBorder], ['MANY Leagues.& 6 Sports', phoneBorder], ["Live Updates", phoneBorder], ["and mini Leagues!", phoneBorder]]
        const screenshotStory2 = [['create your.prediction', two], ['MANY Leagues.& 6 Sports', phoneBorder]]
        const screenshotStory5 = [['', "#0f0f0f11"], ['', seriea], ['', wc], ['', f1], ['', championship]]
        const screenshotStory3 = [['Predict the 2022. world cup', 0], ['Share or save.your tree', 0], ['compete vs. others', 0], ['collect badges,earn medals', 0], ['', 0], ['light or.dark mode', 1], ['', 1], ['', 0], ['', 0], ['Check out your.friends trees', 0]]
        createTile(screenshotStory2)
        /* Make your player, Create your prediction, versus Friends, and the world!, Earn Rewards!, in 25 Leagues & 6 Sports,  Live Updates, public leagues     */
    </script>
</body>

</html>